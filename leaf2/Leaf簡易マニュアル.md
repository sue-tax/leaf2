# Ｌｅａｆ簡易マニュアル

## 1.概要

　Ｌｅａｆは、ツリー形式によるデータを計算を行うソフトウェアです。
　Ｅｘｃｅｌのような表形式は、行・列によりセルを指定しますが、
Ｌｅａｆは親子関係・兄弟関係によりノード（Excelのセルのようなもの）を指定します。
　~~各ノードには、タイトルとデータ・式を入力します。~~

　現バージョンでは、入出力としてFreeMindを利用します。

## 2.ツリー形式

　ツリー形式は、パソコンのファイルのフォルダ・サブフォルダのイメージです。
　ツリー内のデータは、ノード毎に「タイトル」と「値」で管理されています。

　親ノード
　├─────長男ノード
　│　　　　　　├─────孫１ノード
　│　　　　　　└─────孫２ノード
　└─────次男ノード
　　　　　　　　├─────孫３ノード
　　　　　　　　└─────孫４ノード

　長男ノードから孫１ノードは、{孫１ノード}
　孫２ノードから長男ノードは、{..}
　長男ノードから次男ノードは、{../次男ノード}
のように指定することができます。
　{//孫３ノード}は、ツリー内の全ての「孫３ノード」のタイトルの
ノードを指定したことになります。
　ノードの指定は、他にも様々な方法があります。

## 3.データ入力(FreeMindの利用)



　~~データを入力したいノードの行をクリックすると、~~
~~画面下にノードの内容が表示されます。~~
　~~各欄に入力後に、「ＯＫ」ボタンをクリックすると、~~
~~データが入力されます。~~
　~~この入力により影響を受ける他のノードについては、~~
~~値がクリアされ、その行は赤字で表示されます。~~
　~~「再計算」ボタンをクリックすると、~~
~~値がクリアされたノードの値を計算します。~~

　~~ノードの行をクリックしたときに、~~
~~薄青色になった行のノードは、クリックしたノードが参照しているノードであり、~~
~~薄緑色になった行のノードは、クリックしたノードを参照しているノードです。~~

4.ノードの追加・削除
　~~ノードの追加や削除をすると、他のノードの計算式で参照しているノードが~~
~~ずれてくる場合があります。（{%m-n}や{#m+n}のようなノードの指定方法の場合）~~
　~~ずれる可能性があるノードの行は、オレンジ色に表示されます。~~
　~~計算式を変更するか、そのままでよいかを確認してください。~~

## 5.ノードの指定方法

　計算式の中で他のノードの値を使うときは、{xxxxx}のような形で、ノードを指定します。

　なお、ノードの指定方法は、XPathという手法を基本に、独自の書換えを行なっています。

　`#n`は、サポート外にする予定

### 5-1.基本

　[税金計算:値なし]
　├─[所得税:値なし]
　│　├─────孫１ノード
　│　└─────孫２ノード
　└─────次男ノード
　　　　　　　　├─────孫３ノード
　　　　　　　　└─────孫４ノード

　複数データ

### 5-2.祖先ノードの省略記法

　親ノードを指定する場合は`..`とし、親ノードの親ノードは`../..`とします。

　さらに祖先のノードを指定する場合に、`..4`のように記述すると`../../../..`と指定したことになります。

### 5-3. ノード名参照記法

　`$`は、

### 5-4.参照記法

　`%n-m`

### 5-5.置換記法

　`#n`

### 5-5.FreeMind用にXPathへの書き換え

`./子/孫`とノード指定されれば、XPathはFreeMindの保存ファイルのXML形式にあわせて内部では`./node[@TEXT='子']/node[@TEXT='孫']`の形でノードを探します。





6.関数

## 7.表

### 7-1.表のセルの指定方法

`{表ノード}[行のインデックス指定][列のインデックス指定]`

#### インデックス指定

`[インデックス式]`　１行、１列の指定

`[:]`　行全体、列全体の指定

`[インデックス式:]`　インデックス式から最後までの指定（インデックス式で指定した行、列を含む）

`[:インデックス式]` 　最初からインデックス式までの指定（インデックス式で指定した行、列を含む）

#### インデックス式

数式、

`#`、`#+数式`、`#-数式`  未サポート

　表のセルから表のセルの指定方法　#



